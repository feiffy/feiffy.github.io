import{_ as l}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as c,c as i,a as s,b as n,d as a,w as r,e as t,r as e}from"./app.6f7e30ef.js";const u={},k=s("strong",null,"Zend Framework 1",-1),d=s("p",null,"PS\uFF1A\u6211\u5728\u68B3\u7406\u7684\u65F6\u5019\uFF0C\u624D\u53D1\u73B0\u5176\u5B9E\u6211\u672C\u8EAB\u5BF9\u4E8E\u5B83\u4E5F\u662F\u4E0D\u591F\u4E86\u89E3\u7684\uFF0C\u4E1A\u52A1\u4E0A\u57FA\u672C\u4E0A\u719F\u6089\u4E86\u5E38\u7528\u7684\u4E1C\u897F\u4E4B\u540E\uFF0C\u5C31\u4E0D\u600E\u4E48\u5173\u6CE8\u6846\u67B6\u672C\u8EAB\u7684\u4E1C\u897F\u4E86\uFF0C\u6240\u4EE5\u8BF4\u8FD9\u6B21\u6574\u7406\u4E5F\u7B97\u662F\u6E29\u6545\u800C\u77E5\u65B0\uFF0C\u5E2E\u52A9\u522B\u4EBA\u7684\u540C\u65F6\uFF0C\u4E5F\u5E2E\u52A9\u4E86\u81EA\u5DF1\u3002",-1),v=s("h2",{id:"first-of-all",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#first-of-all","aria-hidden":"true"},"#"),n(" First of all")],-1),b={href:"https://packages.zendframework.com/releases/ZendFramework-1.12.20/ZendFramework-1.12.20.tar.gz",target:"_blank",rel:"noopener noreferrer"},m=t(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ZendFramework-1.12.20
<span class="token operator">|</span>-- bin
<span class="token operator">|</span>   <span class="token operator">|</span>-- zf.sh
<span class="token operator">|</span>   <span class="token variable"><span class="token variable">\`</span>-- <span class="token punctuation">..</span>.
<span class="token operator">|</span>-- library
<span class="token operator">|</span>   <span class="token operator">|</span>-- Zend
<span class="token variable">\`</span></span>-- <span class="token punctuation">..</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),h={href:"http://zf.sh",target:"_blank",rel:"noopener noreferrer"},f={href:"http://zf.sh",target:"_blank",rel:"noopener noreferrer"},g=t(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">ln</span> <span class="token parameter variable">-s</span> /home/<span class="token operator">&lt;</span>user<span class="token operator">&gt;</span>/Downloads/ZendFramework-1.12.20/bin/zh.sh /usr/bin/zf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u7136\u540E\uFF0C\u53EF\u4EE5\u7528 zf \u547D\u4EE4\u521B\u5EFA\u9879\u76EE\u4E86\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ zf create-project training
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u9ED8\u8BA4\u521B\u5EFA\u7684\u9879\u76EE\u76EE\u5F55\u7ED3\u6784\u5982\u4E0B\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>training
<span class="token operator">|</span>-- application
<span class="token operator">|</span>   <span class="token operator">|</span>-- Bootstrap.php
<span class="token operator">|</span>   <span class="token operator">|</span>-- configs
<span class="token operator">|</span>   <span class="token operator">|</span>   <span class="token variable"><span class="token variable">\`</span>-- application.ini
<span class="token operator">|</span>   <span class="token operator">|</span>-- controllers
<span class="token operator">|</span>   <span class="token operator">|</span>   <span class="token operator">|</span>-- ErrorController.php
<span class="token operator">|</span>   <span class="token operator">|</span>   <span class="token variable">\`</span></span>-- IndexController.php
<span class="token operator">|</span>   <span class="token operator">|</span>-- models
<span class="token operator">|</span>   <span class="token variable"><span class="token variable">\`</span>-- views
<span class="token operator">|</span>       <span class="token operator">|</span>-- helpers
<span class="token operator">|</span>       <span class="token variable">\`</span></span>-- scripts
<span class="token operator">|</span>           <span class="token operator">|</span>-- error
<span class="token operator">|</span>           <span class="token operator">|</span>   <span class="token variable"><span class="token variable">\`</span>-- error.phtml
<span class="token operator">|</span>           <span class="token variable">\`</span></span>-- index
<span class="token operator">|</span>               <span class="token variable"><span class="token variable">\`</span>-- index.phtml
<span class="token operator">|</span>-- library
<span class="token operator">|</span>-- public
<span class="token operator">|</span>   <span class="token operator">|</span>-- .htaccess
<span class="token operator">|</span>   <span class="token variable">\`</span></span>-- index.php
<span class="token variable"><span class="token variable">\`</span>-- tests
    <span class="token operator">|</span>-- application
    <span class="token operator">|</span>   <span class="token variable">\`</span></span>-- bootstrap.php
    <span class="token operator">|</span>-- library
    <span class="token operator">|</span>   <span class="token variable"><span class="token variable">\`</span>-- bootstrap.php
    <span class="token variable">\`</span></span>-- phpunit.xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5148\u6D4F\u89C8\u4E00\u4E0B\u8FD9\u4E2A\u9879\u76EE\u7684\u76EE\u5F55\u7ED3\u6784\uFF0C\u540E\u9762\u5C06\u4F1A\u9010\u4E00\u5206\u6790\u6BCF\u4E2A\u6587\u4EF6\u548C\u76EE\u5F55\u7684\u4F5C\u7528\u3002</p><h2 id="index-php" tabindex="-1"><a class="header-anchor" href="#index-php" aria-hidden="true">#</a> index.php</h2><p>\u56E0\u4E3A\u6240\u6709\u7684 Web \u8BF7\u6C42\u90FD\u5C06\u88AB\u91CD\u5B9A\u4F4D\u5230 index.php\u4E0A\uFF0C\u6240\u4EE5\u5148\u6765\u770B index.php \u7684\u5185\u5BB9\uFF0C\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">// Define path to application directory</span>
<span class="token function">defined</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;APPLICATION_PATH&#39;</span><span class="token punctuation">)</span>
    <span class="token operator">||</span> <span class="token class-name">define</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;APPLICATION_PATH&#39;</span><span class="token punctuation">,</span> <span class="token function">realpath</span><span class="token punctuation">(</span><span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;/../application&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Define application environment</span>
<span class="token function">defined</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;APPLICATION_ENV&#39;</span><span class="token punctuation">)</span>
    <span class="token operator">||</span> <span class="token class-name">define</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;APPLICATION_ENV&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token function">getenv</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;APPLICATION_ENV&#39;</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">getenv</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;APPLICATION_ENV&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">&#39;production&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Ensure library/ is on include_path</span>
<span class="token function">set_include_path</span><span class="token punctuation">(</span><span class="token function">implode</span><span class="token punctuation">(</span><span class="token constant">PATH_SEPARATOR</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
    <span class="token function">realpath</span><span class="token punctuation">(</span><span class="token constant">APPLICATION_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;/../library&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">get_include_path</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/** Zend_Application */</span>
<span class="token keyword">require_once</span> <span class="token string single-quoted-string">&#39;Zend/Application.php&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// Create application, bootstrap, and run</span>
<span class="token variable">$application</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Zend_Application</span><span class="token punctuation">(</span>
    <span class="token constant">APPLICATION_ENV</span><span class="token punctuation">,</span>
    <span class="token constant">APPLICATION_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;/configs/application.ini&#39;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$application</span><span class="token operator">-&gt;</span><span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token operator">-&gt;</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7B2C4\u884C\u548C\u7B2C8\u884C\u5B9A\u4E49\u4E86\u4E24\u4E2A\u5E38\u91CF\uFF0CAPPLICATION_PATH - \u5E94\u7528\u7684\u6839\u8DEF\u5F84\uFF0CAPPLICATION_ENV - \u5E94\u7528\u7684\u8FD0\u884C\u73AF\u5883\uFF0C\u8FD9\u4E24\u4E2A\u5E38\u91CF\u662F\u9ED8\u8BA4\u751F\u6210\u7684\uFF0C\u7528\u4E8E\u5728\u914D\u7F6E\u6587\u4EF6\uFF08configs/application.ini\uFF09\u4E2D\u6307\u5B9A\u76F8\u5E94\u8DEF\u5F84\u3002</p><p>\u7B2C12\u884C\u589E\u52A0\u4E86PHP\u7684include_path\uFF0C\u9ED8\u8BA4PHP\u7684include_path\u662F\u5728php.ini\u4E2D\u6307\u5B9A\u7684\uFF0C\u8FD9\u91CC\u628A\u6211\u4EEC\u81EA\u5DF1\u7684library\u76EE\u5F55\u5305\u62EC\u4E86\u8FDB\u53BB\uFF0C\u8FD9\u6837PHP\u5728\u89E3\u6790\u7C7B\u7684\u65F6\u5019\u4F1A\u5230\u8FD9\u4E2A\u76EE\u5F55\u4E2D\u53BB\u627E\uFF0C\u540E\u9762\u5C06\u4F1A\u8BE6\u8FF0\u8FD9\u4E2A\u5BFB\u627E\u7C7B\u7684\u8FC7\u7A0B\u3002</p><p>\u7B2C18\u884C <code>require_once &#39;Zend/Application.php&#39;;</code> \u5305\u62EC\u4E86\u4E00\u4E2AApplication.php\u6587\u4EF6\u3002PHP\u6267\u884C\u5230\u8FD9\u4E00\u6B65\u7684\u65F6\u5019\uFF0C\u4F1A\u53BBinclude_path\u5217\u8868\u91CC\u9762\u5BFB\u627E\u6709\u6CA1\u6709Zend\u76EE\u5F55\uFF0C\u7136\u540E\u518D\u53BBZend\u76EE\u5F55\u5BFB\u627E\u6709\u6CA1\u6709Application.php\u3002\u6211\u4EEC\u7EE7\u7EED\u6267\u884C\uFF0C\u7136\u540E\u62A5\u4E86\u4E00\u4E2A\u9519\u8BEF\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>PHP Fatal error:  require_once<span class="token punctuation">(</span><span class="token punctuation">)</span>: Failed opening required <span class="token string">&#39;Zend/Application.php&#39;</span> <span class="token punctuation">(</span>include_path<span class="token operator">=</span><span class="token string">&#39;/home/feiffy/Repo/feiffy/Training/library:.:/usr/share/php&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u663E\u7136\uFF0CPHP\u6CA1\u6709\u627E\u5230\u8FD9\u4E2A\u6587\u4EF6\uFF0C\u6240\u4EE5\u62A5\u9519\u4E86\uFF0C\u5B83\u53BB\u4E86\u8FD9\u4E09\u4E2A\u76EE\u5F55\uFF08/home/feiffy/Repo/feiffy/Training/library\uFF0C.\uFF0C/usr/share/php\uFF09\u4E2D\u53BB\u627E\u4E86\uFF0C\u90FD\u6CA1\u6709\u627E\u5230\u3002\u8FD9\u4E2A\u6587\u4EF6\u662F\u6846\u67B6\u63D0\u4F9B\u7684\uFF0C\u7528\u4E8E\u521D\u59CB\u5316Zend Application\uFF0C\u4E4B\u524D\u6211\u4EEC\u53EA\u662F\u7528zf\u547D\u4EE4\u521B\u5EFA\u4E86\u57FA\u4E8EZend1\u7684\u9879\u76EE\uFF0C\u4F46\u662F\u6CA1\u6709\u628AZend1\u6846\u67B6\u672C\u8EAB\u5F15\u5165\u8FDB\u53BB\uFF0C\u6240\u4EE5\u62A5\u4E86\u8FD9\u4E2A\u9519\u8BEF\u3002\u73B0\u5728\u53EF\u4EE5\u770B\u5230\uFF0CPHP\u786E\u5B9E\u53BB\u6211\u4EEC\u8BBE\u7F6E\u7684 /home/feiffy/Repo/feiffy/Training/library \u53BB\u627E\u4E86\uFF0C\u6240\u4EE5\u53EF\u4EE5\u628A Zend \u6846\u67B6\u653E\u5230\u8FD9\u91CC\uFF0C\u8FD9\u91CC\u7684 Zend \u6846\u67B6\u5C31\u662F\u4E4B\u524D\u4E0B\u8F7D\u7684 ZendFramework1.12.20/library/Zend \u76EE\u5F55\uFF0C\u5C06\u5176\u6574\u4F53\u7684\u590D\u5236\u5230 /home/feiffy/Repo/feiffy/Training/library \u76EE\u5F55\u4E2D\u5373\u53EF\u3002\u8FD8\u6709\u4E00\u79CD\u65B9\u5F0F\u662F\u76F4\u63A5\u5EFA\u7ACB\u8F6F\u94FE\u63A5\uFF08\u76F8\u5F53\u4E8E Windows \u4E2D\u7684\u5FEB\u6377\u65B9\u5F0F\uFF09\uFF0C\u6211\u504F\u5411\u4E8E\u8FD9\u79CD\uFF0C\u8FD9\u6837\u51CF\u5C11\u4E86\u6587\u4EF6\u7684\u590D\u5236\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code>$ ln <span class="token operator">-</span>s <span class="token operator">/</span>home<span class="token operator">/</span><span class="token operator">&lt;</span>user<span class="token operator">&gt;</span><span class="token operator">/</span>Downloads<span class="token operator">/</span>ZendFramework<span class="token operator">-</span><span class="token number">1.12</span><span class="token number">.20</span><span class="token operator">/</span>library<span class="token operator">/</span>Zend <span class="token operator">/</span>home<span class="token operator">/</span>feiffy<span class="token operator">/</span>Repo<span class="token operator">/</span>feiffy<span class="token operator">/</span>Training<span class="token operator">/</span>library<span class="token operator">/</span>Zend
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8FD9\u6B21PHP\u5C31\u80FD\u627E\u5230\u6587\u4EF6\u4E86\uFF0C\u518D\u8BF4\u4E00\u904D\u5176\u8FC7\u7A0B\uFF1APHP\u641C\u7D22include_path\u4E2D\u7684\u6240\u6709\u8DEF\u5F84\uFF0C\u53D1\u73B0\u5728 /home/feiffy/Repo/feiffy/Training/library \u4E2D\u662F\u5B58\u5728 Zend/Application.php \u6587\u4EF6\u7684\uFF0C\u6240\u4EE5\u5C31\u52A0\u8F7D\u4E86\u5B83\u3002</p><p>\u518D\u770B Application.php \u7684\u5185\u5BB9\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Zend_Application</span> <span class="token punctuation">{</span>
 <span class="token operator">...</span><span class="token operator">.</span>
<span class="token punctuation">}</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5B83\u5B9A\u4E49\u4E86\u4E00\u4E2A Zend_Application \u7C7B\uFF0C\u8FD9\u4E2A\u7C7B\u5C31\u662F\u6574\u4E2A Zend \u5E94\u7528\u3002</p><p>\u7136\u540E\u770B\u7B2C21\u884C\uFF0C\u5B9E\u4F8B\u5316\u4E86\u4E00\u4E2A Zend_Application \u5E94\u7528\uFF0C\u73B0\u5728\u4E3B\u8981\u770B\u4F20\u5165\u7684\u7B2C\u4E8C\u4E2A\u53C2\u6570\uFF1Aapplication.ini \u7684\u5185\u5BB9\uFF0C\u73B0\u5728\u5168\u90E8\u662F\u9ED8\u8BA4\u751F\u6210\u7684\uFF1A</p><div class="language-ini ext-ini line-numbers-mode"><pre class="language-ini"><code><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">production</span><span class="token punctuation">]</span></span>
...
<span class="token key attr-name">includePaths.library</span> <span class="token punctuation">=</span> <span class="token value attr-value">APPLICATION_PATH &quot;/../library&quot;</span>
<span class="token key attr-name">bootstrap.path</span> <span class="token punctuation">=</span> <span class="token value attr-value">APPLICATION_PATH &quot;/Bootstrap.php&quot;</span>
<span class="token key attr-name">bootstrap.class</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;<span class="token inner-value">Bootstrap</span>&quot;</span>
<span class="token key attr-name">resources.frontController.controllerDirectory</span> <span class="token punctuation">=</span> <span class="token value attr-value">APPLICATION_PATH &quot;/controllers&quot;</span>
...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u91CC\u53EA\u5217\u51FA\u4E86\u4E00\u4E9B\u91CD\u8981\u7684\u914D\u7F6E\uFF0C\u8FD9\u91CC\u7684\u914D\u7F6E\u5C06\u4F1A\u5728\u540E\u9762\u7684 Zend_Application \u7684\u521D\u59CB\u5316\u4E2D\u4F1A\u7528\u5230\u3002</p><h2 id="application-php" tabindex="-1"><a class="header-anchor" href="#application-php" aria-hidden="true">#</a> Application.php</h2><p>\u73B0\u5728\u6211\u4EEC\u6765\u770B Zend_Application \u7684\u5B9E\u4F8B\u5316\u8FC7\u7A0B\u3002</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Zend_Application</span>
<span class="token punctuation">{</span>
    <span class="token operator">...</span>
    
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$environment</span><span class="token punctuation">,</span> <span class="token variable">$options</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">,</span> <span class="token variable">$suppressNotFoundWarnings</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">require_once</span> <span class="token string single-quoted-string">&#39;Zend/Loader/Autoloader.php&#39;</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">_autoloader</span> <span class="token operator">=</span> <span class="token class-name static-context">Zend_Loader_Autoloader</span><span class="token operator">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">...</span>
        <span class="token variable">$options</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">_loadConfig</span><span class="token punctuation">(</span><span class="token variable">$options</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">setOptions</span><span class="token punctuation">(</span><span class="token variable">$options</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5176\u5B9E\u5C31\u505A\u4E86\u4E24\u4EF6\u4E8B\uFF1A\u521D\u59CB\u5316 _autoloader \u5C5E\u6027\u548C options \u5C5E\u6027\u3002</p><p>_autoloader \u662F Zend1 \u6846\u67B6\u81EA\u5DF1\u5B9E\u73B0\u7684\u4E00\u4E2A\u7C7B\u52A0\u8F7D\u5668\uFF0C\u5176\u7C7B\u540D\u4E3A Zend_Loader_Autoloader\uFF0C\u7A0D\u540E\uFF0C\u7528\u5230\u5B83\u7684\u65F6\u5019\u518D\u8BB2\u5B83\u7684\u52A0\u8F7D\u7C7B\u7684\u8FC7\u7A0B\uFF0C\u6B64\u5904\u5C31\u628A\u5B83\u5F53\u505A\u5E94\u7528\u7684\u4E00\u4E2A\u5C5E\u6027\u5C31\u597D\u4E86\u3002</p><p>\u7136\u540E\uFF0C\u4ECE\u914D\u7F6E\u6587\u4EF6 application.ini \u8F6C\u6362\u4E3A\u914D\u7F6E\u4E3A\u4E00\u4E2A $options \u6570\u7EC4\uFF0C\u5176\u5185\u5BB9\u5982\u4E0B\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$options</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
    <span class="token string double-quoted-string">&quot;includePaths&quot;</span> <span class="token operator">=&gt;</span> <span class="token string double-quoted-string">&quot;/home/feiffy/Repo/feiffy/Training/../library&quot;</span><span class="token punctuation">,</span>
    <span class="token string double-quoted-string">&quot;bootstrap&quot;</span> <span class="token operator">=&gt;</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
        <span class="token string double-quoted-string">&quot;path&quot;</span> <span class="token operator">=&gt;</span> <span class="token string double-quoted-string">&quot;/home/feiffy/Repo/feiffy/Training/Bootstrap.php&quot;</span><span class="token punctuation">,</span>
        <span class="token string double-quoted-string">&quot;class&quot;</span> <span class="token operator">=&gt;</span> <span class="token string double-quoted-string">&quot;Bootstrap&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string double-quoted-string">&quot;resources&quot;</span> <span class="token operator">=&gt;</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
        <span class="token string double-quoted-string">&quot;frontController&quot;</span> <span class="token operator">=&gt;</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
            <span class="token string double-quoted-string">&quot;controllerDirectory&quot;</span> <span class="token operator">=&gt;</span> <span class="token string double-quoted-string">&quot;/home/feiffy/Repo/feiffy/Training/controllers&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token operator">...</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>setOptions()</strong></p><p>\u6700\u540E\u662F setOptions() \u65B9\u6CD5\u3002</p><p>setOptions() \u65B9\u6CD5\u4E0D\u4EC5\u8BBE\u7F6E\u4E86 _options \u5C5E\u6027\uFF0C\u8FD8\u505A\u4E86\u5176\u4ED6\u7684\u521D\u59CB\u5316\u64CD\u4F5C\uFF0C\u4E3B\u8981\u7684\u5C31\u662F\u5B9E\u4F8B\u5316\u4E86 _bootstrap \u5C5E\u6027\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token operator">...</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">setOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">_options</span> <span class="token operator">=</span> <span class="token variable">$options</span><span class="token punctuation">;</span> <span class="token comment"># \u8BBE\u7F6E _options \u5C5E\u6027</span>

    <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">setIncludePaths</span><span class="token punctuation">(</span><span class="token variable">$options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;includepaths&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment"># \u8BBE\u7F6Einclude_paths\uFF0C\u628Aini\u91CC\u9762\u7684\u8DEF\u5F84\u52A0\u5230\u4E86\u539F\u5148\u7684include_paths\u5217\u8868\u91CC\u9762\u53BB</span>

    <span class="token comment"># \u521D\u59CB\u5316 _bootstrap \u5C5E\u6027\uFF0C\u540E\u9762\u4F1A\u8BE6\u8FF0\u8FD9\u4E2A _bootstrap \u5C5E\u6027</span>
    <span class="token variable">$bootstrap</span> <span class="token operator">=</span> <span class="token variable">$options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;bootstrap&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$path</span>  <span class="token operator">=</span> <span class="token variable">$bootstrap</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;path&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token variable">$bootstrap</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;class&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">setBootstrap</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">,</span> <span class="token variable">$class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="bootstrap-php" tabindex="-1"><a class="header-anchor" href="#bootstrap-php" aria-hidden="true">#</a> Bootstrap.php</h2><p><strong>setBootstrap()</strong></p><p>setBootstrap() \u8BBE\u7F6E\u5E94\u7528\u7684 _bootstrap \u5C5E\u6027\u3002</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">setBootstrap</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">,</span> <span class="token variable">$class</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">null</span> <span class="token operator">==</span> <span class="token variable">$class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;Bootstrap&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">require_once</span> <span class="token variable">$path</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">_bootstrap</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token variable">$class</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u6BB5\u4EE3\u7801\u521D\u59CB\u5316\u4E86\u5E94\u7528\u7684 _bootstrap \u5C5E\u6027\uFF0C\u6B64\u65F6 $path \u7684\u503C\u4E3A\uFF1A&quot;/home/feiffy/Repo/feiffy/Training/application/Bootstrap.php&quot;\uFF0C\u6587\u4EF6\u5185\u5BB9\u5982\u4E0B\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Bootstrap</span> <span class="token keyword">extends</span> <span class="token class-name">Zend_Application_Bootstrap_Bootstrap</span>
<span class="token punctuation">{</span>


<span class="token punctuation">}</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7136\u540E <code>$bootstrap = new $class();</code> \u5C31\u662F\u8BA9PHP\u53BB\u627E Bootstrap \u7C7B\uFF0C\u800C\u5728\u4E0A\u4E00\u6B65\u4E2D require \u4E86 Bootstrap.php \u6587\u4EF6\uFF0C\u6240\u4EE5\u6700\u7EC8\u5728 /home/feiffy/Repo/feiffy/Training/application/Bootstrap.php \u6587\u4EF6\u4E2D\u627E\u5230\u4E86\uFF0C\u4E8E\u662F\u5B9E\u4F8B\u5316\u8BE5\u7C7B\u3002</p><p>\u9ED8\u8BA4\u8FD9\u4E2A\u6587\u4EF6\u7684\u5185\u5BB9\u662F\u7A7A\u7684\uFF0C\u4F46\u662F\u5B83\u975E\u5E38\u91CD\u8981\uFF0C\u5E94\u7528\u6240\u6709\u7684\u8D44\u6E90\u7684\u521D\u59CB\u5316\u90FD\u8981\u5199\u5728\u8FD9\u4E2A\u7C7B\u91CC\u9762\u3002\u5B9E\u4F8B\u5316 Bootstrap \u65F6\u6B64\u5904\u6CA1\u6709\u5B9A\u4E49 __construct() \u65B9\u6CD5\uFF0C\u6240\u4EE5PHP\u4F1A\u53BB\u6267\u884C\u7236\u7C7B Zend_Application_Bootstrap_Bootstrap \u7684 __construct() \u65B9\u6CD5\u3002\u7236\u7C7B\u5B9A\u4E49\u5982\u4E0B\uFF0C\u53EF\u89C1\u5B83\u53C8\u7EE7\u627F\u4E86\u4E00\u4E2A\u62BD\u8C61\u7236\u7C7B\u3002</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">class</span> <span class="token class-name-definition class-name">Zend_Application_Bootstrap_Bootstrap</span>
    <span class="token keyword">extends</span> <span class="token class-name">Zend_Application_Bootstrap_BootstrapAbstract</span>
<span class="token punctuation">{</span>
    <span class="token keyword static-context">parent</span><span class="token operator">::</span><span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$application</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>bootstrap\u7684\u4E3B\u8981\u529F\u80FD\u90FD\u662F\u7531\u8FD9\u4E2A\u62BD\u8C61\u7236\u7C7B\u63D0\u4F9B\u7684\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">Zend_Application_Bootstrap_BootstrapAbstract</span>
    <span class="token keyword">implements</span> <span class="token class-name">Zend_Application_Bootstrap_Bootstrapper</span><span class="token punctuation">,</span>
               Zend_Application_Bootstrap_ResourceBootstrapper
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$application</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">setApplication</span><span class="token punctuation">(</span><span class="token variable">$application</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$options</span> <span class="token operator">=</span> <span class="token variable">$application</span><span class="token operator">-&gt;</span><span class="token function">getOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">setOptions</span><span class="token punctuation">(</span><span class="token variable">$options</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="loader-php" tabindex="-1"><a class="header-anchor" href="#loader-php" aria-hidden="true">#</a> Loader.php</h2><p>\u4F46\u662F\u8FD9\u91CC\u6709\u4E00\u4E2A<strong>\u95EE\u9898</strong>\uFF1ABootstrap \u7C7B\u6240\u7EE7\u627F\u7684 Zend_Application_Bootstrap_Bootstrap \u7C7B\u662F\u5982\u4F55\u627E\u5230\u5B83\u6240\u5728\u7684\u7C7B\u5B9A\u4E49\u7684\u6587\u4EF6\u7684\u5462\uFF1F\u8FD9\u91CC\u5E76\u4E0D\u50CF\u5B9E\u4F8B\u5316Bootstrap\u7C7B\u4E4B\u524Drequire\u4E86\u4E00\u4E2ABootstrap.php\u6587\u4EF6\uFF0C\u5230\u76EE\u524D\u4E3A\u6B62\uFF0C\u6240\u6709require\u7684\u6587\u4EF6\u4E2D\u90FD\u6CA1\u6709\u5305\u542BZend_Application_Bootstrap_Bootstrap \u7C7B\u7684\u5B9A\u4E49\u3002\u4E0A\u6587\u5728\u4ECB\u7ECD Bootstrap \u7684\u5B9E\u4F8B\u5316\u65F6\u76F4\u63A5\u5C31\u8DF3\u8F6C\u5230\u4E86 Zend_Application_Bootstrap_Bootstrap-&gt;__construct() \u65B9\u6CD5\uFF0C\u8FD9\u4E2D\u95F4\u5FC5\u5B9A\u7ECF\u8FC7\u4E86\u4E00\u4E2A\u5F88\u91CD\u8981\u7684\u8FC7\u7A0B\u3002\u8FD9\u4E2A\u8FC7\u7A0B\u5C31\u662FPHP\u81EA\u52A8\u52A0\u8F7D\u7684\u8FC7\u7A0B\uFF0C\u8FD8\u8BB0\u5F97\u4E4B\u524D\u63D0\u5230\u7684 Zend_Loader \u7C7B\u5417\uFF1F\u5728\u5B9E\u4F8B\u5316 Zend_Application \u7C7B\u7684\u65F6\u5019\u6DFB\u52A0\u4E86\u4E00\u4E2A _autoloader \u5C5E\u6027\u3002\u6211\u4EEC\u518D\u56DE\u5230\u4E0A\u9762\u8BE6\u7EC6\u770B\u4E00\u4E0B\uFF0C\u5B83\u662F\u5982\u4F55\u88AB\u521D\u59CB\u5316\u7684\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token comment">#1 Zend_Application</span>
    <span class="token keyword">require_once</span> <span class="token string single-quoted-string">&#39;Zend/Loader/Autoloader.php&#39;</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">_autoloader</span> <span class="token operator">=</span> <span class="token class-name static-context">Zend_Loader_Autoloader</span><span class="token operator">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#2 Zend_Loader_Autoloader</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">null</span> <span class="token operator">===</span> <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token variable">$_instance</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token variable">$_instance</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">self</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token variable">$_instance</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">spl_autoload_register</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token constant">__CLASS__</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;autoload&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">_internalAutoloader</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;_autoload&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7B2C2\u884C\uFF0CAutoloader.php \u4E2D\u5B9A\u4E49\u4E86 Zend_Loader_Autoloader \u7C7B\uFF0C\u88AB require \u4E86\uFF0C\u6240\u4EE5\u7B2C3\u884C\u80FD\u591F\u52A0\u8F7D\u8BE5\u7C7B\u5E76\u8C03\u7528\u4E00\u4E2A\u9759\u6001\u65B9\u6CD5 getInstance()\uFF0C\u5176\u5B9E\u5C31\u662F\u5B9E\u4F8B\u5316\u672C\u8EAB\uFF0C\u5B9E\u4F8B\u5316\u4F1A\u81EA\u52A8\u8C03\u7528__construct()\uFF0C\u6240\u4EE5\u518D\u53BB\u770B\u5B83\u7684 __construct() \u65B9\u6CD5\u3002\u770B\u5230\u4E00\u4E2A\uFF1A<strong>spl_autoload_register()</strong>\uFF0C\u8FD9\u662F\u4EC0\u4E48\uFF1F\u8FD9\u662FPHP\u7528\u6765\u6CE8\u518C\u81EA\u52A8\u52A0\u8F7D\u51FD\u6570\u7684\u4E00\u4E2A\u65B9\u6CD5\u3002\u8FD9\u91CC\u5C31\u628A Zend_Loader_Autoloader-&gt;autoload() \u65B9\u6CD5\u6CE8\u518C\u4E3A\u4E00\u4E2A\u7C7B\u81EA\u52A8\u52A0\u8F7D\u5668\u3002\u5F53\u9047\u5230\u9700\u8981\u89E3\u6790\u7C7B\u540D\u7684\u65F6\u5019\uFF0C\u5C31\u4F1A\u81EA\u52A8\u627E\u5230\u8FD9\u4E2A\u7C7B\u52A0\u8F7D\u5668\uFF0C\u628A\u7C7B\u540D\u4EA4\u7ED9\u5B83\uFF0C\u7136\u540E\u5B83\u901A\u8FC7\u81EA\u5DF1\u5B9A\u4E49\u7684\u89C4\u5219\uFF0C\u89E3\u6790\u51FA\u7C7B\u6240\u5728\u7684\u6587\u4EF6\u540D\uFF0C\u52A0\u8F7D\u8BE5\u6587\u4EF6\uFF0C\u7136\u540E\u5C31\u80FD\u5B9E\u4F8B\u5316\u6240\u9700\u8981\u7684\u7C7B\u4E86\u3002</p><p>\u6709\u4E86\u7C7B\u52A0\u8F7D\u5668\u4E4B\u540E\uFF0C\u4E0A\u9762\u5728 require Bootstrap.php \u6587\u4EF6\u65F6\uFF0C\u53D1\u73B0 Bootstrap \u7C7B\u7EE7\u627F\u81EA Zend_Application_Bootstrap_Bootstrap \u7C7B\uFF0C\u7136\u540E PHP \u4F1A\u53BB\u89E3\u6790\u8BE5\u7C7B\uFF0C\u7ED3\u679C\u53D1\u73B0\u73B0\u5728\u6240\u6709\u7684 require \u7684\u6587\u4EF6\u91CC\u9762\u90FD\u6CA1\u6709\u8BE5\u7C7B\u7684\u5B9A\u4E49\uFF0C\u9ED8\u8BA4\u7684\u89E3\u6790\u89C4\u5219\u627E\u4E0D\u5230\u7C7B\u6587\u4EF6\uFF0C\u6240\u4EE5\u5C31\u4EA4\u7ED9 Zend_Loader_Autoloader-&gt;autoload()\uFF0C\u5728 Zend_Loader_Autoloader \u91CC\u9762\u7ECF\u8FC7\u4E00\u756A\u89C4\u5219\u8F6C\u6362\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">autoload</span><span class="token punctuation">(</span><span class="token variable">$class</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$autoloader</span><span class="token punctuation">,</span> <span class="token variable">$class</span><span class="token punctuation">)</span> <span class="token comment">// $autoloader-&gt;autoload()</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">_autoload</span><span class="token punctuation">(</span><span class="token variable">$class</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$callback</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">getDefaultAutoloader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$callback</span><span class="token punctuation">,</span> <span class="token variable">$class</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// $this-&gt;loadClass()</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">loadClass</span><span class="token punctuation">(</span><span class="token variable">$class</span><span class="token punctuation">,</span> <span class="token variable">$dirs</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token function">standardiseFile</span><span class="token punctuation">(</span><span class="token variable">$class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">...</span>
        <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token function">loadFile</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token variable">$dirs</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">standardiseFile</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$fileName</span> <span class="token operator">=</span> <span class="token function">ltrim</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;\\\\&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$file</span>      <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;&#39;</span><span class="token punctuation">;</span>
        <span class="token variable">$namespace</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;&#39;</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$lastNsPos</span> <span class="token operator">=</span> <span class="token function">strripos</span><span class="token punctuation">(</span><span class="token variable">$fileName</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;\\\\&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$namespace</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$fileName</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$lastNsPos</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$fileName</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$fileName</span><span class="token punctuation">,</span> <span class="token variable">$lastNsPos</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$file</span>      <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;\\\\&#39;</span><span class="token punctuation">,</span> <span class="token constant">DIRECTORY_SEPARATOR</span><span class="token punctuation">,</span> <span class="token variable">$namespace</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token constant">DIRECTORY_SEPARATOR</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token variable">$file</span> <span class="token operator">.=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;_&#39;</span><span class="token punctuation">,</span> <span class="token constant">DIRECTORY_SEPARATOR</span><span class="token punctuation">,</span> <span class="token variable">$fileName</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;.php&#39;</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">loadFile</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$dirs</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">,</span> <span class="token variable">$once</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$once</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">include_once</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">include</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7ECF\u8FC7\u5C42\u5C42\u8C03\u7528\uFF0C\u6700\u7EC8\u5728 standardiseFile() \u65B9\u6CD5\u4E2D\uFF0C\u628A Zend_Application_Bootstrap_Bootstrap \u8F6C\u6362\u4E3A &quot;Zend/Application/Bootstrap/Bootstrap.php&quot; \u8DEF\u5F84\uFF0C\u7136\u540E\u5728 loadFile() \u65B9\u6CD5\u4E2D\u52A0\u8F7D\u4E86\u8BE5\u6587\u4EF6\u3002\u52A0\u8F7D\u6587\u4EF6\u662F\u6309\u7167\u8DEF\u5F84\u5C42\u7EA7\u4E00\u7EA7\u4E00\u7EA7\u5F80\u4E0B\u627E\u65F6\uFF0CPHP\u9996\u5148\u53BB include_paths \u76EE\u5F55\u5217\u8868\u4E2D\u53BB\u5BFB\u627E\u6709\u6CA1\u6709 Zend \u76EE\u5F55\uFF0C\u7ED3\u679C\u53D1\u73B0\u5728 /home/feiffy/Repo/feiffy/training/library \u4E2D\u627E\u5230\u4E86\uFF0C\u5E76\u4E14\u540E\u9762\u7684\u5B50\u76EE\u5F55\u4E5F\u6B63\u786E\u627E\u5230\u4E86\uFF0C\u4E8E\u662F\u52A0\u8F7D\u4E86 Bootstrap.php \u6587\u4EF6\uFF0C\u8FD9\u4E2A\u6587\u4EF6\u4E2D\u5B9A\u4E49\u4E86 Zend_Application_Bootstrap_Bootstrap \u7C7B\u3002\u6240\u4EE5 PHP \u73B0\u5728\u77E5\u9053\u4E86\u8FD9\u4E2A\u7C7B\u5728\u8FD9\u4E2A\u6587\u4EF6\u91CC\uFF0C\u76F4\u63A5\u5B9E\u4F8B\u5316\u5B83\uFF0C\u5E76\u8C03\u7528\u4E86 __construct()\u3002</p><p>Zend1\u6846\u67B6\u8FD9\u79CD\u98CE\u683C\u7684\u52A0\u8F7D\u6587\u4EF6\u7684\u65B9\u5F0F\u662F\u8001\u7248PHP\u4EE3\u7801\u6D41\u884C\u7684\u98CE\u683C\uFF0C\u901A\u8FC7\u4E0B\u5212\u7EBF\u6765\u5339\u914D\u76EE\u5F55\u5C42\u7EA7\uFF0C\u73B0\u5728\u5DF2\u7ECF\u8FC7\u65F6\uFF0C\u8FD9\u91CC\u53EA\u8981\u4E86\u89E3\u4E00\u4E0B\u5C31\u597D\u4E86\uFF0C\u65B0\u7248\u7684PHP\u81EA\u52A8\u52A0\u8F7D\u98CE\u683C\u8BF7\u53C2\u8003\u5B98\u65B9\u6587\u6863\uFF1APSR-4\u3002</p><h2 id="index-php-1" tabindex="-1"><a class="header-anchor" href="#index-php-1" aria-hidden="true">#</a> index.php</h2><p>_bootstrap \u5C5E\u6027\u5B9E\u4F8B\u5316\u5B8C\u6210\u4E4B\u540E\uFF0C\u5C31\u56DE\u5230 index.php \u4E2D\u7684 <code>$application-&gt;bootstrap()-&gt;run();</code>\u3002\u5E94\u7528\u7684\u542F\u52A8\u662F\u901A\u8FC7 Bootstrap \u7C7B\u7684 bootstrap() \u65B9\u6CD5\u542F\u52A8\u7684\uFF0C\u8C03\u7528\u987A\u5E8F\u5982\u4E0B\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token comment"># index.php</span>
<span class="token variable">$application</span><span class="token operator">-&gt;</span><span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Zend_Application-&gt;bootstrap()</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">bootstrap</span><span class="token punctuation">(</span><span class="token variable">$resource</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">getBootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token variable">$resource</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token comment"># Zend_Application_Bootstrap_BootstrapAbstract-&gt;bootstrap()</span>
    <span class="token keyword">final</span> <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">bootstrap</span><span class="token punctuation">(</span><span class="token variable">$resource</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">_bootstrap</span><span class="token punctuation">(</span><span class="token variable">$resource</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">_bootstrap</span><span class="token punctuation">(</span><span class="token variable">$resource</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">null</span> <span class="token operator">===</span> <span class="token variable">$resource</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">getClassResourceNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$resource</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">_executeResource</span><span class="token punctuation">(</span><span class="token variable">$resource</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">getPluginResourceNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$resource</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">_executeResource</span><span class="token punctuation">(</span><span class="token variable">$resource</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$resource</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">_executeResource</span><span class="token punctuation">(</span><span class="token variable">$resource</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$resource</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$resource</span> <span class="token keyword">as</span> <span class="token variable">$r</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">_executeResource</span><span class="token punctuation">(</span><span class="token variable">$r</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Zend_Application_Bootstrap_Exception</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Invalid argument passed to &#39;</span> <span class="token operator">.</span> <span class="token constant">__METHOD__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6700\u7EC8\u5728 _bootstrap() \u4E2D\u52A0\u8F7D\u4E86\u6240\u6709\u7684\u8D44\u6E90\uFF0C\u81F3\u6B64\u5E94\u7528\u7684\u521D\u59CB\u5316\u3001\u542F\u52A8\u7ED3\u675F\u3002\u63A5\u4E0B\u6765\u6267\u884C run() \u65B9\u6CD5\u83B7\u53D6\u524D\u7AEF\u63A7\u5236\u5668\u8D44\u6E90\uFF0C\u901A\u8FC7\u524D\u7AEF\u63A7\u5236\u5668\u5904\u7406\u8DEF\u7531\u3001\u5206\u53D1\u8BF7\u6C42\u548C\u8F93\u51FA\u54CD\u5E94\u3002</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token comment"># Zend_Application-&gt;run()</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">getBootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token comment"># Zend_Application_Bootstrap_Bootstrap-&gt;run()</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$front</span>   <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;FrontController&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$default</span> <span class="token operator">=</span> <span class="token variable">$front</span><span class="token operator">-&gt;</span><span class="token function">getDefaultModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">null</span> <span class="token operator">===</span> <span class="token variable">$front</span><span class="token operator">-&gt;</span><span class="token function">getControllerDirectory</span><span class="token punctuation">(</span><span class="token variable">$default</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Zend_Application_Bootstrap_Exception</span><span class="token punctuation">(</span>
                <span class="token string single-quoted-string">&#39;No default controller directory registered with front controller&#39;</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token variable">$front</span><span class="token operator">-&gt;</span><span class="token function">setParam</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;bootstrap&#39;</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$response</span> <span class="token operator">=</span> <span class="token variable">$front</span><span class="token operator">-&gt;</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$front</span><span class="token operator">-&gt;</span><span class="token function">returnResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token variable">$response</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728\u8FD9\u4E00\u6B65\u91CC\u9762\uFF0C\u521D\u59CB\u5316front\u524D\u7AEF\u63A7\u5236\u5668\uFF0C\u7531\u524D\u7AEF\u63A7\u5236\u5668\u8D1F\u8D23\u628A\u8BF7\u6C42\u5206\u53D1\u7ED9\u76F8\u5E94\u7684\u5177\u4F53\u7684Controller\uFF0C\u8FD4\u56DEController\u6240\u4EA7\u751F\u7684\u54CD\u5E94\u6570\u636E\u3002\u5230\u8FD9\u4E00\u6B65\u4E4B\u540E\u5C31\u662F\u540E\u9762\uFF0C\u6838\u5FC3\u7684\u7C7B\u5C31\u662F Controller \u7C7B\u4E86\u3002</p><h2 id="front-php" tabindex="-1"><a class="header-anchor" href="#front-php" aria-hidden="true">#</a> Front.php</h2><p>Front.php \u4E2D\u5B9A\u4E49\u4E86 Zend_Controller_Front \u5373\u524D\u7AEF\u63A7\u5236\u5668\uFF0C\u7528\u4E8E\u628A\u8BF7\u6C42\u5206\u53D1\u7ED9\u76F8\u5E94\u7684\u5177\u4F53\u7684\u63A7\u5236\u5668\uFF0C\u5E76\u4E14\u63A5\u6536\u54CD\u5E94\uFF0C\u8DEF\u7531\u529F\u80FD\u5C31\u7531\u5B83\u63A7\u5236\u7684\u3002\u5B83\u6709\u4E00\u4E2A\u6838\u5FC3\u65B9\u6CD5 dispatch()\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">class</span> <span class="token class-name-definition class-name">Zend_Controller_Front</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">dispatch</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Zend_Controller_Request_Abstract</span> <span class="token variable">$request</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">Zend_Controller_Response_Abstract</span> <span class="token variable">$response</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">require_once</span> <span class="token string single-quoted-string">&#39;Zend/Controller/Request/Http.php&#39;</span><span class="token punctuation">;</span>
        <span class="token variable">$request</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Zend_Controller_Request_Http</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">setRequest</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">...</span>
        <span class="token keyword">require_once</span> <span class="token string single-quoted-string">&#39;Zend/Controller/Response/Http.php&#39;</span><span class="token punctuation">;</span>
        <span class="token variable">$response</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Zend_Controller_Response_Http</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">setResponse</span><span class="token punctuation">(</span><span class="token variable">$response</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">...</span>
        <span class="token variable">$router</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">getRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token variable">$dispatcher</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">getDispatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token operator">...</span>
        <span class="token variable">$dispatcher</span><span class="token operator">-&gt;</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">_request</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">_response</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
        <span class="token operator">...</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">_response</span><span class="token operator">-&gt;</span><span class="token function">sendResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">null</span> <span class="token operator">==</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">_router</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">require_once</span> <span class="token string single-quoted-string">&#39;Zend/Controller/Router/Rewrite.php&#39;</span><span class="token punctuation">;</span>
            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">setRouter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Zend_Controller_Router_Rewrite</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">_router</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728\u521D\u59CB\u5316\u7A7A\u7684 Request \u548C Response \u5BF9\u8C61\uFF0C\u4EE5\u53CA\u8BBE\u7F6E\u4E86 router \u5BF9\u8C61\u4E4B\u540E\uFF0C\u7136\u540E\u83B7\u53D6 FrontController \u7684 dispatcher \u5BF9\u8C61\uFF0C\u8C03\u7528\u8BE5\u5BF9\u8C61\u7684 dispatch() \u65B9\u6CD5\u3002FrontController \u76F8\u5F53\u4E8E\u5206\u53D1\u6D41\u7A0B\u7684\u5BB9\u5668\uFF0C\u771F\u6B63\u5B9E\u73B0\u8DEF\u7531\u5206\u53D1\u7684\u662F dispatcher \u5BF9\u8C61\uFF0C\u5373 Zend_Controller_Dispatcher_Standard \u7C7B\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">class</span> <span class="token class-name-definition class-name">Zend_Controller_Dispatcher_Standard</span> <span class="token keyword">extends</span> <span class="token class-name">Zend_Controller_Dispatcher_Abstract</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">dispatch</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Zend_Controller_Request_Abstract</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">Zend_Controller_Response_Abstract</span> <span class="token variable">$response</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token operator">...</span>
        <span class="token variable">$className</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">getControllerClass</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$className</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$className</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">getDefaultControllerClass</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token variable">$moduleClassName</span> <span class="token operator">=</span> <span class="token variable">$className</span><span class="token punctuation">;</span>
        <span class="token operator">...</span>
        <span class="token variable">$className</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token variable">$className</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token operator">...</span>
        <span class="token variable">$controller</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token variable">$moduleClassName</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">getParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token operator">...</span>
        <span class="token variable">$action</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">getActionMethod</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token operator">...</span>
        <span class="token variable">$controller</span><span class="token operator">-&gt;</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token operator">...</span>
        <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">ob_get_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$response</span><span class="token operator">-&gt;</span><span class="token function">appendBody</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4ECE request \u4E2D\u83B7\u53D6 indexController \u7C7B\u540D\uFF0C\u52A0\u8F7D\u7C7B\u6587\u4EF6\u3002\u8FD9\u4E2A\u65B9\u6CD5\u91CC\u9762\u89E3\u6790\u5230\u7684 indexController \u6587\u4EF6\u540D\u4E3A\uFF1A&quot;/home/feiffy/Repo/feiffy/Training/application/controllers/IndexController.php&quot; \u7136\u540E\u52A0\u8F7D\u4E4B\u3002</p><p>\u7B2C16\u884C\uFF0C\u6700\u7EC8\u5B9E\u4F8B\u5316\u4E86\u5177\u4F53\u7684 IndexController \u7C7B\uFF0C\u8FD9\u5C31\u4ECE\u6846\u67B6\u5C42\u5230\u4E86\u6211\u4EEC\u7684\u4E1A\u52A1\u5C42\u3002</p><p>\u7B2C23\u884C\uFF0C\u6267\u884C\u5230\u4E1A\u52A1action\u3002</p><p>\u7B2C27\u884C\uFF0C\u83B7\u53D6\u8F93\u51FA\u7F13\u5B58\u4E2D\u7684\u6570\u636E\uFF0C\u5E76\u6E05\u7406\u8F93\u51FA\u7F13\u5B58\uFF0C\u5C06\u5176\u5185\u5BB9\u6DFB\u52A0\u5230 response \u5BF9\u8C61\u4E2D\u3002\u6267\u884C\u5B8C\u8FD9\u4E00\u5207\u4E4B\u540E\uFF0C\u8FD4\u56DE\u4E0A\u5C42\u8C03\u7528\uFF0C\u7EE7\u7EED\u6267\u884C\u5230 FrontController\uFF0C\u8C03\u7528 reponse \u5BF9\u8C61\u7684 sendResponse() \u65B9\u6CD5\uFF0C\u8F93\u51FA\u5185\u5BB9\u5230\u6D4F\u89C8\u5668\u3002</p><p>\u4E0B\u9762\u7B80\u8981\u8BB2\u4E00\u8BB2 Reponse \u5BF9\u8C61\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">Zend_Controller_Response_Abstract</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">sendResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">sendHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token operator">...</span>

        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">outputBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">outputBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$body</span> <span class="token operator">=</span> <span class="token function">implode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">_body</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token variable">$body</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>sendHeaders() \u8F93\u51FAHTTP\u62A5\u6587\u7684\u5934\u90E8\uFF0C\u8FD9\u662FHTTP\u534F\u8BAE\u89C4\u5B9A\u7684\u5185\u5BB9\u5C31\u4E0D\u5FC5\u591A\u8BF4\uFF0CoutputBody() \u65B9\u6CD5\u8F93\u51FA\u5185\u5BB9\u90E8\u5206\uFF0C\u5176\u5B9E\u5F88\u7B80\u5355\uFF0C\u5C31\u662F\u628A Response \u5BF9\u8C61\u4E2D\u7684 _body \u6570\u7EC4\u91CC\u9762\u5B58\u50A8\u7684\u5B57\u7B26\u4E32\u503C\u5168\u90E8\u8FDE\u63A5\u8D77\u6765\u8F93\u51FA\u5C31OK\u4E86\u3002</p><p><code>echo</code> \u51FD\u6570\u9ED8\u8BA4\u662F\u8F93\u51FA\u5230\u6807\u51C6\u8F93\u51FA\uFF08\u5BF9\u4E8E\u7EAFPHP\u811A\u672C\u7684\u8BDD\uFF0C\u5C31\u662F\u5C4F\u5E55\u6216\u8005\u63A7\u5236\u53F0\uFF09\uFF0C\u4F46\u8FD9\u91CC\u662F Web \u9879\u76EE\uFF0C\u6D4F\u89C8\u5668\u53D1\u51FA\u8BF7\u6C42\u9996\u5148\u5230 Apache \u670D\u52A1\u5668\uFF0C\u7136\u540E\u6839\u636E Apache \u7684\u914D\u7F6E\u8C03\u7528\u4E86 PHP \u6765\u63A5\u6536\u8BF7\u6C42\uFF0C\u5904\u7406\u8BF7\u6C42\uFF0C\u6240\u4EE5\u8FD9\u91CC\u7684PHP\u8F93\u51FA\u4F1A\u8FD4\u56DE\u7ED9 Apache\uFF0C\u7136\u540E Apache \u518D\u539F\u6837\u8FD4\u56DE\u7ED9\u6D4F\u89C8\u5668\u3002</p><h2 id="action-php" tabindex="-1"><a class="header-anchor" href="#action-php" aria-hidden="true">#</a> Action.php</h2><p>\u6240\u6709\u7684 Controller \u90FD\u7EE7\u627F\u81EA Zend_Controller_Action \u7C7B\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">Zend_Controller_Action</span> <span class="token keyword">implements</span> <span class="token class-name">Zend_Controller_Action_Interface</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Zend_Controller_Request_Abstract</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">Zend_Controller_Response_Abstract</span> <span class="token variable">$response</span><span class="token punctuation">,</span> <span class="token keyword type-hint">array</span> <span class="token variable">$invokeArgs</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">setRequest</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span>
             <span class="token operator">-&gt;</span><span class="token function">setResponse</span><span class="token punctuation">(</span><span class="token variable">$response</span><span class="token punctuation">)</span>
             <span class="token operator">-&gt;</span><span class="token function">_setInvokeArgs</span><span class="token punctuation">(</span><span class="token variable">$invokeArgs</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">_helper</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Zend_Controller_Action_HelperBroker</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">dispatch</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">preDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">...</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token variable">$action</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">...</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">postDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token operator">...</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">_helper</span><span class="token operator">-&gt;</span><span class="token function">notifyPostDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8BE5\u7C7B\u5B9E\u4F8B\u5316\u65F6\u4F1A\u6267\u884C init() \u65B9\u6CD5\uFF0C\u9ED8\u8BA4\u662F\u7A7A\u7684\uFF0C\u6240\u4EE5\u6211\u4EEC\u53EF\u4EE5\u5728\u81EA\u5DF1\u5199\u7684 Controller \u91CC\u9762\u91CD\u5199 init() \u65B9\u6CD5\u6765\u505A\u4E9B\u521D\u59CB\u5316\u7684\u5DE5\u4F5C\u3002</p><p>\u6700\u7EC8\u4F7F\u7528 dispatch() \u6765\u8C03\u7528 action()\uFF0CpreDispatch() \u662F\u5728\u8C03\u7528 action() \u524D\u7684\u51C6\u5907\u5DE5\u4F5C\uFF0CpostDispatch() \u662F\u5728\u8C03\u7528 action() \u7684\u6536\u5C3E\u5DE5\u4F5C\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5728\u5B50\u7C7B\uFF08\u81EA\u5DF1\u5199\u7684 Controller \uFF09\u4E2D\u7684\u8FD9\u4E24\u4E2A\u65B9\u6CD5\u91CC\u9762\u53EF\u4EE5\u52A0\u4E0A\u5BF9\u8BF7\u6C42\u53C2\u6570\u3001\u8FD4\u56DE\u54CD\u5E94\u505A\u4E00\u4E9B\u5904\u7406\uFF0C\u6216\u8005\u5355\u7EAF\u8BB0\u5F55\u65E5\u5FD7\u7B49\u5DE5\u4F5C\u3002 \u800C action() \u5219\u662F\u6267\u884C\u5177\u4F53\u4E1A\u52A1\u64CD\u4F5C\u7684\u65B9\u6CD5\u3002</p><p>\u73B0\u5728\u6211\u4EEC\u518D\u4ED4\u7EC6\u770B\u4E00\u4E0B\u6700\u540E\u4E00\u4E2A notifyPostDispatch() \u65B9\u6CD5\uFF0C\u8FD0\u884C\u5230\u8FD9\u91CC\u65F6\uFF0CController \u5176\u5B9E\u5DF2\u7ECF\u6267\u884C\u5B8C\u4E86\uFF0C\u8FD9\u4E2A\u65B9\u6CD5\u4E3B\u8981\u901A\u77E5\u76F8\u5173\u7684 helper \u7C7B\u66F4\u65B0\u5B83\u4EEC\u7684\u72B6\u6001\uFF0C\u5176\u4E2D\u6709\u4E00\u4E2A\u91CD\u8981\u7684 helper\uFF1AZend_Controller_Action_Helper_ViewRenderer\uFF0C\u7528\u6765\u6E32\u67D3\u89C6\u56FE\u5C42\u7684\u7C7B\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token comment">#1 Zend_Controller_Action_HelperBroker</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">notifyPostDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token function">getStack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$helper</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$helper</span><span class="token operator">-&gt;</span><span class="token function">postDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token comment">#2 Zend_Controller_Action_Helper_ViewRenderer</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">postDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">_shouldRender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">render</span><span class="token punctuation">(</span><span class="token variable">$action</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">,</span> <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">,</span> <span class="token variable">$noController</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">setRender</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">,</span> <span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$noController</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$path</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">getViewScript</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">renderScript</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">,</span> <span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">renderScript</span><span class="token punctuation">(</span><span class="token variable">$script</span><span class="token punctuation">,</span> <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token operator">...</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">appendBody</span><span class="token punctuation">(</span>
            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">view</span><span class="token operator">-&gt;</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$script</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token variable">$name</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">...</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7B2C19\u884C\u521D\u59CB\u5316\u9700\u8981\u7684\u4E1C\u897F\uFF0C\u7B2C20\u884C\u83B7\u53D6\u9700\u8981\u6E32\u67D3\u7684phtml\u811A\u672C\u6587\u4EF6\uFF0C\u7B2C21\u884C\u6E32\u67D3\u8BE5\u6587\u4EF6\u3002</p><p><code>getViewScript()</code> \u9ED8\u8BA4\u628A application/views/scripts/ \u5F53\u505A\u89C6\u56FE\u811A\u672C\u6587\u4EF6\u7684\u6839\u76EE\u5F55\uFF0C\u7136\u540E\u6309\u7167 controller/action \u7684\u547D\u540D\u89C4\u5219\u53BB\u5BFB\u627E\u76F8\u5E94\u7684.phtml\u89C6\u56FE\u811A\u672C\u6587\u4EF6\uFF08.phtml\u6587\u4EF6\u5176\u5B9E\u5C31\u662Fphp\u548Chtml\u4EE3\u7801\u6DF7\u5408\u7684\u6587\u4EF6\uFF0Cphp\u53EF\u4EE5\u76F4\u63A5\u8BFB\u53D6\u3002\uFF09\uFF0C\u6BD4\u5982 index/index \u7684\u8BF7\u6C42\u5C06\u4F1A\u53BB\u627E index/index.phtml \u6587\u4EF6\u3002\u5F53\u7136\uFF0C\u8FD9\u4E2A\u662F\u9ED8\u8BA4\u7684\u914D\u7F6E\uFF0C\u4F60\u4E5F\u53EF\u4EE5\u5728 action() \u65B9\u6CD5\u4E2D\u4F7F\u7528\u65B9\u6CD5\u6307\u5B9A\u67D0\u4E2A\u89C6\u56FE\u6587\u4EF6\uFF0C\u8FD9\u5C31\u4E0D\u63D0\u4E86\u3002</p><p><code>rederScript()</code> \u65B9\u6CD5\u8C03\u7528\u89C6\u56FE\u5BF9\u8C61view\u7684render()\u65B9\u6CD5\u6E32\u67D3\u811A\u672C\u6587\u4EF6\uFF0C\u90A3\u4E48\u6E32\u67D3\u662F\u4EC0\u4E48\u610F\u601D\u5462\uFF1F\u770BView\u5BF9\u8C61\u7684\u5B9A\u4E49\u5C31\u77E5\u9053\u4E86.</p><h2 id="view-php" tabindex="-1"><a class="header-anchor" href="#view-php" aria-hidden="true">#</a> View.php</h2><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">Zend_View_Abstract</span> <span class="token keyword">implements</span> <span class="token class-name">Zend_View_Interface</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">render</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// find the script file name using the parent private method</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">_file</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">_script</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">unset</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// remove $name from local scope</span>

        <span class="token function">ob_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">_run</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">_file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">_filter</span><span class="token punctuation">(</span><span class="token function">ob_get_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// filter output</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">_run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token operator">...</span>
        <span class="token keyword">include</span> <span class="token function">func_get_arg</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function-definition function">_filter</span><span class="token punctuation">(</span><span class="token variable">$buffer</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token operator">...</span>
        <span class="token keyword">return</span> <span class="token variable">$buffer</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5176\u5B9EView\u5BF9\u8C61\u6E32\u67D3\u7684\u539F\u7406\u5F88\u7B80\u5355\uFF0C\u5C31\u662F\u5148\u5F00\u542F\u8F93\u51FA\u7F13\u51B2\u533A<code>ob_start()</code>\uFF0C\u7136\u540Einclude\u4E86\u4E00\u4E2A\u89C6\u56FE\u6587\u4EF6(.phtml)\uFF0C\u8FD9\u4E2A\u6587\u4EF6\u91CC\u9762\u975EPHP\u7684\u4EE3\u7801\u4F1A\u76F4\u63A5\u8F93\u51FA\uFF0CPHP\u7684\u90E8\u5206\u7528echo\u6216printf\u8FD9\u79CD\u8F93\u51FA\u51FD\u6570\u8F93\u51FA\u5185\u5BB9\uFF0C\u8F93\u51FA\u7F13\u51B2\u5F00\u542F\u4E4B\u540E\uFF0C\u6240\u6709\u8F93\u51FA\u7684\u5185\u5BB9\u4F1A\u5168\u90E8\u5B58\u5728\u7F13\u51B2\u533A\u91CC\u9762\uFF0C\u7136\u540E\u8C03\u7528<code>ob_get_clean()</code> \u83B7\u53D6\u7F13\u51B2\u533A\u5185\u5BB9\u5B57\u7B26\u4E32\u5E76\u6E05\u7406\u7F13\u51B2\u533A\uFF0C\u7136\u540E\u8FD4\u56DE\u6240\u6709\u7684\u5B57\u7B26\u4E32\u7ED9\u4E0A\u5C42\u8C03\u7528\u3002\u6700\u540E\u6240\u6709\u5B57\u7B26\u4E32\u5185\u5BB9\u901A\u8FC7 Response \u5BF9\u8C61\u7684 appendBody() \u65B9\u6CD5\u6DFB\u52A0\u5230\u5176 _body \u5C5E\u6027\u91CC\u9762\uFF0C\u6700\u540E\u901A\u8FC7 Response \u5BF9\u8C61\u7684\u8F93\u51FA\u65B9\u6CD5\uFF0C\u8FD4\u56DE\u7ED9 Apache\uFF0C\u7136\u540EPHP\u7ED3\u675F\u8FD0\u884C\u3002</p>`,84);function _(y,$){const o=e("RouterLink"),p=e("ExternalLinkIcon");return c(),i("div",null,[s("p",null,[k,n(" \u662F\u4E00\u4E2A\u5341\u5E74\u524D\u7684\u8001\u6846\u67B6\u4E86\uFF0C\u6211\u63A5\u89E6\u5B83\u4E5F\u6709\u4E24\u5E74\u4E86\uFF0C\u73B0\u5728\u6765\u5199\u8FD9\u7BC7\u6587\u7AE0\uFF0C\u4E3B\u8981\u539F\u56E0\u662F\u6700\u8FD1\u8981\u5199\u5165\u804C\u57F9\u8BAD\u6559\u7A0B\u3002\u516C\u53F8\u9879\u76EE\u57FA\u672C\u4E0A\u90FD\u662F\u57FA\u4E8EZend1\u6846\u67B6\uFF0C\u5373\u4F7F\u73B0\u5728\u8981\u8F6C Laravel \u4E5F\u80AF\u5B9A\u8981\u6709\u597D\u957F\u4E00\u6BB5\u65F6\u95F4\u7684\u8FC7\u6E21\u8FC7\u7A0B\uFF0C\u800C\u4E14\u57FA\u672C\u4E0A\u662F\u65B0\u9879\u76EE\u7528 Laravel\uFF0C\u8001\u9879\u76EE\u57FA\u672C\u4E0D\u4F1A\u518D\u91CD\u6784\u4E86\u3002\u56E0\u6B64\uFF0C\u65B0\u4EBA\u5165\u804C\u7684\u8BDD\uFF0C\u8FD8\u662F\u9700\u8981\u57F9\u8BAD\u4E00\u4E0B Zend Framework 1 \u7684\uFF0C\u4E4B\u524D\u628AZend\u5B98\u65B9\u6587\u6863\u7684\u63D0\u4F9B\u7684\u4E00\u4E2A\u5165\u95E8\u6559\u7A0B\u7FFB\u8BD1\u6574\u7406\u4E86\u4E00\u904D\uFF0C\u4F5C\u4E3A"),a(o,{to:"/_posts/zend-framework-1-quick-start.html"},{default:r(()=>[n("\u5165\u95E8\u6559\u7A0B")]),_:1}),n("\uFF0C\u4F46\u8FD9\u6B21\u53C8\u770B\u4E86\u4E00\u904D\u4E4B\u540E\u53D1\u73B0\uFF0C\u90A3\u7BC7\u6559\u7A0B\u53EA\u662F\u6559\u4F60\u5982\u4F55\u505A\uFF0C\u662F\u4EC0\u4E48\uFF0C\u5374\u6CA1\u6709\u8BB2\u5173\u4E8E\u6574\u4E2A\u6846\u67B6\u7684\u6574\u4F53\u7684\u903B\u8F91\uFF0C\u6240\u4EE5\uFF0C\u8FD9\u7BC7\u6587\u7AE0\u5C31\u662F\u4E3A\u4E86\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\u7684\u3002\u9605\u8BFB\u5B8C\u672C\u6587\u4E4B\u540E\uFF0C\u4F60\u5C06\u52A0\u6DF1\u7406\u89E3Zend1\u6846\u67B6\u7684\u542F\u52A8\u3001\u8FD0\u884C\u7684\u5B8C\u6574\u6D41\u7A0B\u3002\u53EA\u6709\u7406\u89E3\u4E86\u8FD9\u4E2A\u5B8C\u6574\u7684\u6D41\u7A0B\uFF0C\u624D\u80FD\u5728\u4F7F\u7528\u65F6\u6216\u9047\u5230\u95EE\u9898\u65F6\u8FC5\u901F\u89E3\u51B3\u95EE\u9898\uFF0C\u627E\u5230\u89E3\u51B3\u65B9\u6848\u3002")]),d,v,s("p",null,[n("\u9996\u5148\uFF0C\u6211\u4EEC\u4ECE\u5B98\u7F51\u4E0A\u4E0B\u8F7DZend1\u7684\u6700\u65B0\u7248\u672C\u7684 "),s("a",b,[n("ZendFramework-1.12.20 \u6E90\u7801\u5305"),a(p)]),n("\uFF0C\u7136\u540E\u89E3\u538B\uFF0C\u5176\u76EE\u5F55\u7ED3\u6784\u7B80\u5316\u5982\u4E0B\uFF1A")]),m,s("p",null,[n("\u73B0\u5728\u6211\u4EEC\u53EA\u9700\u5173\u6CE8\u4E24\u4E2A\uFF1A"),s("a",h,[n("zf.sh"),a(p)]),n(" \u6587\u4EF6\u548C Zend \u76EE\u5F55\u3002"),s("a",f,[n("zf.sh"),a(p)]),n(" \u662F Zend1 \u63D0\u4F9B\u7684\u4E00\u4E2A\u547D\u4EE4\u884C\u5DE5\u5177\uFF0C\u7528\u4E8E\u521B\u5EFA Project\u3001Controller\u3001Model \u7B49\u7C7B\u3002\u63A5\u4E0B\u6765\u6211\u5C06\u4F7F\u7528\u5B83\u6765\u521B\u5EFA\u4E00\u4E2A\u793A\u4F8B\u9879\u76EE\uFF0C\u4E3A\u4E86\u66F4\u65B9\u4FBF\u5730\u5168\u5C40\u4F7F\u7528\u8BE5\u547D\u4EE4\uFF0C\u628A\u5B83\u94FE\u63A5\u5230\u7CFB\u7EDF\u7684\u73AF\u5883\u53D8\u91CFPATH\u91CC\u9762\uFF0C\u6267\u884C\u547D\u4EE4\u5982\u4E0B\uFF1A")]),g])}const q=l(u,[["render",_],["__file","2018-06-12-how-zend-framework-1-start.html.vue"]]);export{q as default};
